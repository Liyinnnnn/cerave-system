[phases.setup]
nixPkgs = ['php82', 'php82Extensions.mbstring', 'php82Extensions.pdo_mysql', 'php82Extensions.gd']
env = { APP_ENV = "production" }

[phases.install]
cmds = ['composer install --no-dev --optimize-autoloader']

[phases.build]
cmds = ['npm install', 'npm run build']
env = { APP_ENV = "production" }

[start]
cmd = 'php artisan migrate --force 2>/dev/null || true && php -S 0.0.0.0:$PORT -t public'
